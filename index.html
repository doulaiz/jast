<!DOCTYPE html>
<html>

<head>
   <meta charset="UTF-8" />
   <title>JAST - WBA's Favourite Search Tool</title>
   <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
   <link rel="stylesheet" href="jast.css" />
</head>

<body>
   <header>
      <button id="infoBtn" class="menuBtn" title="About">?</button>
      <button id="settingsBtn" class="menuBtn" title="Settings">âš™</button>
   </header>

   <h1 class="jast-title" title="Just Another Search Tool">
      <span class="g1">J</span><span class="g2">A</span><span class="g3">S</span><span class="g4">T</span>
   </h1>

   <input type="text" id="searchQuery" class="search-box" placeholder="Search..." autocomplete="off"
      list="searchHistoryList" />
   <datalist id="searchHistoryList"></datalist>

   <br /><br />

   <input type="file" id="excelFile" accept=".xlsx, .xls" title="Select Excel file with URLs" class="btn"
      style="width: auto" />
   <select id="sheetSelect" style="display: none" title="Choose which sheet from your Excel file to use."></select>
   <select id="columnSelect" style="display: none"
      title="Choose which column from your Excel file to use."></select><br />

   <button id="searchBtn" class="btn" type="button">Search</button>
   <button id="exportBtn" class="btn" type="button" title="Export to Excel" style="display: none">
      Export to Excel
   </button>

   <!-- Spinner + Progress -->
   <div class="spinner-container" id="spinnerContainer">
      <div class="spinner"></div>
      <div class="progress-text" id="progressText">0 / 0</div>
      <div class="progress-bar">
         <div class="progress-fill" id="progressFill"></div>
      </div>
   </div>

   <table id="resultsTable" style="display: none">
      <thead>
         <tr id="resultsHeader">
            <th>URL Used</th>
            <th># of Results</th>
         </tr>
      </thead>
      <tbody></tbody>
   </table>

   <!-- Export Modal -->
   <div id="exportModal" class="modal">
      <div class="modal-content">
         <h2>Export Options</h2>
         <label for="exportFilename">Export file name</label>
         <div style="display: flex; justify-content: center;">
            <input type="text" id="exportFilename" placeholder="jast_results.xlsx" />
         </div>
         <br />
         <label>Select columns from the original Excel to include</label>
         <div id="exportColumnsContainer" class="exportColumnsContainer"></div>
         <div style="display: flex; justify-content: flex-end; gap: 8px; margin-top: 12px;">
            <button class="btn" id="cancelExportBtn" type="button">Cancel</button>
            <button class="btn" id="confirmExportBtn" type="button">Export</button>
         </div>
      </div>
   </div>

   <!-- Settings Modal -->
   <div id="settingsModal" class="modal">
      <div class="modal-content">
         <h2>Settings</h2>
         <label for="snippetCountInput">Number of search results per URL</label>
         <div style="display: flex; justify-content: center;">
            <input type="number" id="snippetCountInput" min="1" max="10" />
         </div>
         <br />
         <br />
         <label for="apiKeyInput">
            Google API Key
            <span id="googleApiSite" title="How to get a Google API Key"
               style="margin-left: 5px; color: #888; cursor: pointer;">
               &#9432;
            </span>
         </label>
         <div style="display: flex; justify-content: center;">
            <input type="text" id="apiKeyInput" />
         </div>

         <label for="cxInput">Custom Search Engine ID

            <span title="Programmable Search Engine. The default provided value should work" style="margin-left: 5px; color: #888;">
               &#9432;
            </span>
         </label>
         <div style="display: flex; justify-content: center;">
            <input type="text" id="cxInput" />
         </div>

         <div style="display: flex; justify-content: flex-end">
            <button class="btn" id="saveSettingsBtn">Save</button>
         </div>
      </div>
   </div>

   <!-- Info Modal -->
   <div id="infoModal" class="modal">
      <div class="modal-content">
         <h2>About JAST</h2>
         <p>
            JAST (Just Another Search Tool) enables you to perform Google searches across multiple websites
            automatically <br /> (<a href="https://github.com/doulaiz/jast?tab=readme-ov-file#readme" target="_blank" rel="noopener noreferrer">more info here</a>)
         </p>
         <h3>How to use it</h3>
         <p>
         <ul>
            <li>Create on your computer an Excel file containing a list of URLs.</li>
            <li>Import it into JAST.</li>
            <li>Type your query phrase in the JAST search bar.</li>
            <li>Start the search and instantly discover if the sites are relevant for your needs.</li>
         </ul>
         </p>
         <br />
         <p style="text-align: center; font-size: 0.9em;">
            &copy; Created by Melinda George and Rafael Deleuze for the <br>
            <em id="wbaLink" style="cursor: pointer; font-style: italic;">World Benchmarking Alliance</em>
         </p>
         </p>
         <div style="display: flex; justify-content: flex-end">
            <button class="btn" id="closeInfoBtn">Close</button>
         </div>
      </div>
   </div>

   <div id="errorBox" class="errorBox"></div>
   <script src="jast.js"></script>
   <footer>
      <span class="footer">JAST v2.0</span>
   </footer>
</body>

</html>